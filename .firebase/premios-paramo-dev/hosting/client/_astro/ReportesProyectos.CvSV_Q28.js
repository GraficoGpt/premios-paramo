import{j as i}from"./jsx-runtime.D_zvdyIk.js";import{r as p}from"./index.BVOCwoKb.js";import{h as u,f as x,b as y,T as f}from"./firebase.CkSkgTuA.js";const d=e=>{if(e instanceof f){const t=e.toDate(),s=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`${s}/${r}/${a}`}if(typeof e=="string"){const t=new Date(e),s=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`${s}/${r}/${a}`}return e},h=(e,t)=>{const s=[],r=Object.keys(e[0]);s.push(r.join(","));for(const l of e){const g=r.map(m=>`"${(""+(l[m]??"")).replace(/"/g,'\\"')}"`);s.push(g.join(","))}const a=s.join(`
`),c=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(c),n=document.createElement("a");n.href=o,n.download=t,n.click()};function E(){const[e,t]=p.useState([]),[s,r]=p.useState(!0);return p.useEffect(()=>{(async()=>{const c=localStorage.getItem("proyectos_cache");if(c){t(JSON.parse(c)),r(!1);return}try{const n=(await u(x(y,"proyectos"))).docs.map(l=>({id:l.id,...l.data()}));t(n),localStorage.setItem("proyectos_cache",JSON.stringify(n))}catch(o){console.error("Error cargando proyectos:",o)}finally{r(!1)}})()},[]),s?i.jsx("p",{className:"text-center py-10",children:"Cargando proyectos..."}):e.length===0?i.jsx("p",{className:"text-center py-10",children:"No hay proyectos registrados."}):i.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gold-600 text-center",children:"Reporte de Proyectos Registrados"}),i.jsx("button",{onClick:()=>{const a=e.map(c=>{const o={...c};return o.fechaEstreno=d(o.fechaEstreno),o.fechaEnvio=d(o.fechaEnvio),o});h(a,"proyectos_registrados.csv")},className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded mx-auto block",children:"Descargar CSV"}),i.jsx("p",{className:"text-center text-gray-500 mt-4 text-sm",children:"Datos cacheados en localStorage."})]})}export{E as default};
