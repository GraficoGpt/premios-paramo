import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.BVOCwoKb.js";import{c as g,a as h,s as N,d as y,b as w,T as E}from"./firebase.CkSkgTuA.js";import{C}from"./categories.ChSHB25j.js";function R(){const[n,t]=r.useState(""),[o,i]=r.useState(!1),[u,m]=r.useState(!1);r.useEffect(()=>{typeof window<"u"&&(localStorage.getItem("userRole")!=="admin"?window.location.href="/":m(!0))},[]);const p=async a=>{a.preventDefault(),t(""),i(!0);const x=a.target,c=new FormData(x),l=Object.fromEntries(c.entries());try{const s=l.email?.toString().toLowerCase().trim(),d=l.celular?.toString().trim(),f=`*${d}*`,b=(await g(h,s||"",f)).user,j=new Date().toLocaleString("es-CO",{hour12:!1});await N(y(w,"jurados",b.uid),{nombreJurado:l.nombreJurado,email:s,celular:d,categorias:c.getAll("categorias"),rol:"jurado",fechaRegistro:j,timestamp:E.now()}),window.location.href="/jurado-gracias"}catch(s){console.error("❌ Error al registrar jurado:",s),s.code==="auth/email-already-in-use"?t("⚠️ El correo ya está registrado como usuario."):t("❌ No se pudo registrar el jurado. Intenta nuevamente."),i(!1)}};return u?e.jsxs("form",{onSubmit:p,className:"space-y-8 max-w-2xl mx-auto p-6",children:[n&&e.jsx("p",{className:"text-red-600",children:n}),o&&e.jsx("p",{className:"text-blue-600",children:"Enviando..."}),e.jsxs("fieldset",{className:"space-y-4",children:[e.jsx("legend",{className:"font-semibold text-lg text-gold-500",children:"🧑 Datos del jurado"}),e.jsxs("label",{className:"block",children:["Nombre y apellido:",e.jsx("input",{name:"nombreJurado",required:!0,className:"w-full p-2 border rounded"})]}),e.jsxs("label",{className:"block",children:["Correo electrónico:",e.jsx("input",{type:"email",name:"email",required:!0,className:"w-full p-2 border rounded"})]}),e.jsxs("label",{className:"block",children:["Celular:",e.jsx("input",{type:"tel",name:"celular",required:!0,className:"w-full p-2 border rounded"})]})]}),e.jsxs("fieldset",{className:"space-y-2",children:[e.jsx("legend",{className:"font-semibold text-lg text-gold-500",children:"🏆 Categorías que evaluará"}),C.map(a=>e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"checkbox",name:"categorias",value:a,className:"mr-2"}),a]},a))]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"reset",className:"border px-4 py-2 rounded text-gray-700",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:o,className:"bg-gold-600 text-black font-semibold px-4 py-2 rounded disabled:opacity-50",children:o?"Enviando...":"Registrar Jurado"})]})]}):null}export{R as default};
